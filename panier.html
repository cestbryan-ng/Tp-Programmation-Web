<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Panier — Artcart</title>
<style>
:root {--accent:#1f2937;--muted:#6b7280;--bg:#f5f5f5;--card:#fff;--border:#e5e7eb;}
body{font-family:'Inter',sans-serif;background:var(--bg);margin:0;padding:0;color:var(--accent);}
header{background:#fff;border-bottom:1px solid var(--border);padding:12px 18px;display:flex;justify-content:space-between;align-items:center;}
.btn{background:var(--accent);color:#fff;padding:8px 14px;border:none;border-radius:8px;cursor:pointer;}
.btn.ghost{background:transparent;color:var(--accent);border:1px solid var(--accent);}
main{max-width:900px;margin:24px auto;padding:0 16px;}
.cart-item{display:flex;gap:10px;align-items:center;padding:12px;background:#fafafa;border:1px solid var(--border);border-radius:8px;margin-bottom:10px;}
.cart-thumb{width:80px;height:80px;overflow:hidden;border-radius:8px;}
.cart-thumb img{width:100%;height:100%;object-fit:cover;}
.cart-meta{flex:1;}
.row{display:flex;justify-content:space-between;margin-top:12px;font-weight:600;font-size:18px;}
input[type=number]{width:60px;padding:6px;border:1px solid #e5e7eb;border-radius:6px;text-align:center;}
</style>
</head>
<body>

<header>
  <div><strong>Artcart</strong> - Panier</div>
  <a href="index.html" class="btn ghost">Retour aux produits</a>
</header>

<main>
  <div id="cart"></div>
  <div class="row" id="totals"></div>
  <div style="margin-top:16px;">
    <button class="btn" id="checkout">Passer à la caisse</button>
    <button class="btn ghost" id="clear-cart">Vider le panier</button>
  </div>
</main>

<script>
const CART_KEY='articart_cart_v1';
const format=v=>new Intl.NumberFormat('fr-FR').format(v)+' FCFA';

function loadCart(){try{return JSON.parse(localStorage.getItem(CART_KEY))||{}}catch(e){return{}}}
function saveCart(cart){localStorage.setItem(CART_KEY,JSON.stringify(cart)); renderCart();}
function clearCart(){localStorage.removeItem(CART_KEY); renderCart();}

const cartEl=document.getElementById('cart');
const totalsEl=document.getElementById('totals');

function calculateTotals(cart){let subtotal=0; Object.values(cart).forEach(i=>subtotal+=i.price*i.qty); const shipping=subtotal>20000?0:(subtotal===0?0:1200); const total=subtotal+shipping; return {subtotal,shipping,total};}

function renderCart(){
  const cart=loadCart();
  cartEl.innerHTML='';
  const items=Object.values(cart);
  if(items.length===0){cartEl.innerHTML='<p>Votre panier est vide.</p>'; totalsEl.innerHTML=''; return;}
  items.forEach(it=>{
    const div=document.createElement('div');
    div.className='cart-item';
    div.innerHTML=`<div class="cart-thumb"><img src="${it.img}"></div>
      <div class="cart-meta">
        <div>${it.title}</div>
        <div>${format(it.price)} x <input type="number" min="1" value="${it.qty}" data-id="${it.id}"/> = ${format(it.price*it.qty)}</div>
      </div>
      <button data-remove="${it.id}" class="btn ghost">Supprimer</button>`;
    cartEl.appendChild(div);
  });
  const totals=calculateTotals(cart);
  totalsEl.innerHTML=`Sous-total: ${format(totals.subtotal)} | Livraison: ${format(totals.shipping)} | Total: ${format(totals.total)}`;
}

// Événements
cartEl.addEventListener('change',e=>{
  const input=e.target.closest('input[type=number][data-id]');
  if(input){ 
    const cart=loadCart(); 
    const id=input.dataset.id; 
    cart[id].qty=Math.max(1, Number(input.value)||1); 
    saveCart(cart);
  }
});

cartEl.addEventListener('click',e=>{
  const rm=e.target.closest('[data-remove]');
  if(rm){ 
    const cart=loadCart(); 
    delete cart[rm.dataset.remove]; 
    saveCart(cart);
  }
});

document.getElementById('clear-cart').addEventListener('click',()=>{if(confirm('Vider le panier ?')) clearCart();});
document.getElementById('checkout').addEventListener('click',()=>{if(Object.keys(loadCart()).length===0){alert('Panier vide');return;} alert('Redirection vers la page de paiement...');});

renderCart();
</script>
</body>
</html>
